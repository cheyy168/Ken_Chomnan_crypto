<!DOCTYPE html>
<html>
<head>
    <title>Secure AES Encryption with Firebase</title>
    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- External JavaScript libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Secure AES Encryption with Firebase</h1>
        <p style="text-align: center; color: #7f8c8d; font-size: 18px; margin-bottom: 30px;">
            Client-side AES-256 encryption for maximum security. Your keys, your data.
        </p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸ”’ End-to-End Encryption</h4>
                <p>Data encrypted in your browser before sending to Firebase</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ”‘ Unique Keys</h4>
                <p>Each note gets a unique AES-256 encryption key</p>
            </div>
            <div class="feature-card">
                <h4>â˜ï¸ Secure Cloud Storage</h4>
                <p>Firebase stores only encrypted data</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“± User Control</h4>
                <p>You control all encryption keys</p>
            </div>
        </div>
        
        <div class="section">
            <h2>â• Add New Note <span id="noteCount" class="note-count">0 notes</span></h2>
            <div id="status"></div>
            
            <input type="text" id="noteName" placeholder="Note Name *" value="My Secret Note" required>
            <input type="text" id="username" placeholder="Username (optional)" value="John Doe">
            <input type="text" id="phone" placeholder="Phone Number (optional)" value="123-456-7890">
            <textarea id="noteText" placeholder="Note Content *" required>This is my secret information that will be encrypted with AES-256 before being sent to Firebase. Only I can decrypt it with my key.</textarea>
            
            <div style="text-align: center;">
                <button onclick="addNote()">
                    <span class="icon">ğŸ”’</span> Encrypt & Save to Firebase
                </button>
                <button class="btn-danger" onclick="clearForm()">
                    <span class="icon">ğŸ—‘ï¸</span> Clear Form
                </button>
            </div>
            
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>Encrypting and saving to Firebase...</p>
            </div>
            
            <div id="keySection" style="display: none; margin-top: 30px;">
                <h3><span class="icon">ğŸ”‘</span> YOUR AES KEY (SAVE THIS!)</h3>
                <div class="key-display" id="generatedKey"></div>
                <div style="text-align: center;">
                    <button onclick="downloadKey()">
                        <span class="icon">ğŸ“¥</span> Download Key as TXT File
                    </button>
                    <button class="btn-danger" onclick="hideKey()">
                        <span class="icon">âœ•</span> Hide Key
                    </button>
                </div>
                <p style="color: #e74c3c; font-size: 16px; margin-top: 20px; text-align: center;">
                    âš ï¸ <strong>WARNING:</strong> Save this key securely! Without it, you cannot decrypt your note.
                    The key was generated in your browser and was never sent to any server.
                </p>
            </div>
        </div>
        
        <div class="section">
            <h2><span class="icon">ğŸ”“</span> Decrypt Your Notes</h2>
            <p style="color: #7f8c8d; margin-bottom: 20px;">Enter the AES key for a specific note to decrypt it</p>
            
            <input type="text" id="decryptKey" placeholder="Paste your AES key here" style="font-family: 'Courier New', monospace;">
            
            <div style="text-align: center; margin: 20px 0;">
                <button class="btn-success" onclick="decryptNotes()">
                    <span class="icon">ğŸ”“</span> Decrypt All Notes with This Key
                </button>
                <button onclick="viewAllNotes()">
                    <span class="icon">ğŸ“‹</span> View Encrypted Notes List
                </button>
            </div>
            
            <!-- Decrypt Status will appear here -->
            <div id="decryptStatus"></div>
            
            <div class="loading" id="decryptLoading">
                <div class="loading-spinner"></div>
                <p>Decrypting notes...</p>
            </div>
            
            <div id="notesTable"></div>
        </div>
        
        <div class="section" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
            <h3><span class="icon">ğŸ“Š</span> System Status & Information</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
                <div>
                    <h4>Firebase Status</h4>
                    <p>Status: <span id="debugStatus" style="color: #27ae60; font-weight: bold;">System Ready</span></p>
                    <p>Project: <code>client-side-aes-encryption</code></p>
                    <button onclick="checkFirebase()">Test Firebase Connection</button>
                </div>
                <div>
                    <h4>Encryption Details</h4>
                    <p>Algorithm: AES-256 (CBC mode)</p>
                    <p>Key Size: 256-bit (32 characters)</p>
                    <p>Collection: <code>notes</code></p>
                </div>
                <div>
                    <h4>Statistics</h4>
                    <p>Notes in Firebase: <span id="noteCountDisplay">0</span></p>
                    <p>Last Operation: <span id="lastOp">None yet</span></p>
                    <button onclick="refreshStats()">Refresh Statistics</button>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="clearAllData()" class="btn-danger">
                    <span class="icon">âš ï¸</span> Clear All Local Data
                </button>
            </div>
        </div>
        
        <div class="footer">
            <p>Secure Notes App | Client-Side AES Encryption | Firebase Integration</p>
            <p>Project ID: client-side-aes-encryption | All encryption happens in your browser</p>
            <p>ğŸ”’ Your data is encrypted before leaving your device. Keys never leave your browser.</p>
        </div>
    </div>

    <!-- Load your JavaScript files -->
    <script src="/env.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>